<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Welcome to the Jungle</title>
	<meta name="author" content="Garmin International"/>
	<meta name="date" content="July 10, 2020"/>
	<link type="text/css" rel="stylesheet" href="resources/programmers-guide/style.css"/>
	<meta name="copyright" content="Welcome to the Jungle - CIQ 3.2, Copyright 2020 Garmin, International."/>
</head>
<body>

<link href="resources/programmers-guide/google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
<script src="resources/programmers-guide/jquery-1.11.3.min.js"></script>
<script>
    $(document).ready( function() {
        $( 'pre' ).addClass( 'prettyprint' );
    } );
</script>
<script src="resources/programmers-guide/google-code-prettify/run_prettify.js"></script>
<div id="connect_iq_logo">
<figure>
<img src="resources/programmers-guide/connect_iq_logo.png" style="max-width:471px;" title="Powered by Garmin" />
</figure>
</div>
<div id="title">Welcome to the Jungle</div>
<div id="tagline">Introduction to Connect IQ</div>
<div class="clear"></div>

<h1 id="tableofcontents">Table of Contents</h1>
<div id="toc">

<ul>
<li><a href="#welcometoconnectiq">Welcome to Connect IQ</a>

<ul>
<li><a href="#monkeyc">Monkey C</a></li>
<li><a href="#devicesandapis">Devices and APIs</a></li>
<li><a href="#thetaoofconnectiq">The Tao of Connect IQ</a></li>
</ul></li>
<li><a href="#gettingstarted">Getting Started</a>

<ul>
<li><a href="#theconnectiqsdkmanagerconnectiq3.2">The Connect IQ SDK Manager (Connect IQ 3.2)</a>

<ul>
<li><a href="#installingtheconnectiqsdkmanager">Installing the Connect IQ SDK Manager</a></li>
</ul></li>
<li><a href="#theeclipseplug-in">The Eclipse Plug-in</a>

<ul>
<li><a href="#installingtheeclipsexmleditor">Installing the Eclipse XML Editor</a></li>
<li><a href="#settheactivesdk">Set the Active SDK</a></li>
<li><a href="#installingtheeclipseplug-in">Installing the Eclipse Plug-in</a></li>
<li><a href="#addtheperspective">Add the Perspective</a></li>
<li><a href="#windowssourcefileencoding">Windows Source File Encoding</a></li>
</ul></li>
<li><a href="#generatingadeveloperkey">Generating a Developer Key</a>

<ul>
<li><a href="#generatingakeyusingtheeclipseplug-in">Generating a Key Using the Eclipse Plug-in</a></li>
</ul></li>
<li><a href="#settingupthecommandline">Setting Up the Command Line</a>

<ul>
<li><a href="#osxinstallation">OS X Installation</a></li>
<li><a href="#windowsinstallation">Windows Installation</a></li>
<li><a href="#linuxinstallation">Linux Installation</a></li>
<li><a href="#basiccommands">Basic Commands</a></li>
<li><a href="#generatingakeyusingopenssl">Generating a Key Using OpenSSL</a></li>
</ul></li>
</ul></li>
<li><a href="#yourfirstconnectiqapp">Your First Connect IQ App</a>

<ul>
<li><a href="#creatingyourfirstproject">Creating Your First Project</a>

<ul>
<li><a href="#abouttheminimumsdkversionfield">About the Minimum SDK Version Field</a></li>
</ul></li>
<li><a href="#runningtheprogram">Running the Program</a>

<ul>
<li><a href="#aboutthetargetsdkversionfield">About the Target SDK Version Field</a></li>
</ul></li>
<li><a href="#importinganexample">Importing an Example</a></li>
<li><a href="#sideloadinganapp">Side Loading an App</a></li>
</ul></li>
<li><a href="#watchfaces">Watch Faces</a>

<ul>
<li><a href="#watchfacesleep">Watchface sleep</a></li>
<li><a href="#watchfacedelegateconnectiq2.3">WatchFaceDelegate (Connect IQ 2.3)</a></li>
</ul></li>
<li><a href="#datafields">Data Fields</a>

<ul>
<li><a href="#datafieldandsimpledatafield">Datafield and SimpleDataField</a>

<ul>
<li><a href="#activityinfo">Activity Info</a></li>
</ul></li>
<li><a href="#simulatingaworkout">Simulating a Workout</a></li>
</ul></li>
<li><a href="#deviceapps">Device Apps</a></li>
<li><a href="#widgets">Widgets</a>

<ul>
<li><a href="#baseviewandthewidgetcarousel">Base View and the Widget Carousel</a></li>
<li><a href="#glancesconnectiq3.1">Glances (Connect IQ 3.1)</a></li>
<li><a href="#designingawidget">Designing a Widget</a></li>
</ul></li>
<li><a href="#audiocontentproviders">Audio Content Providers</a></li>
</ul>
</div>

<h1 id="welcometoconnectiq">Welcome to Connect IQ</h1>

<p>Connect IQ combines three W&#8217;s:</p>

<p><strong>Wear</strong> - Garmin devices don&#8217;t live on a desk or in a pocket. Rather, they are worn on wrists or mounted to bicycles to help our users beat yesterday. Garmin&#8217;s experience in power management, activity tracking, and <a href="http://www.thisisant.com/developer/ant-plus/ant-antplus-defined/" title="What are ANT and ANT+?">ANT or ANT+</a> sensors means our users will spend more time using the products and less time charging them.
 <strong>Where</strong> - Location awareness is at the center of our products. Our products don&#8217;t become dead weight without a smart phone, but become more alive with one.
 <strong>Ware</strong> - Garmin&#8217;s new Connect IQ app system allows for developers to extend their apps into Garmin&#8217;s wearable ecosystem.</p>

<p>Connect IQ products provide the best of what Garmin has to offer like beautiful design, location awareness, and efficient power management with the Connect IQ app system. Using the Connect IQ SDK, developers can create apps for Connect IQ devices and distribute them via the Connect IQ Store.</p>

<h2 id="monkeyc">Monkey C</h2>

<p>Connect IQ apps are created in Monkey C, an object-oriented language designed for easy app development. The goal of Monkey C is to simplify the app building process, letting developers focus more on the customer and less on resource constraints. It uses reference counting to automatically clean up memory, freeing you from focusing on memory management. In addition, the resource compiler helps you import fonts and images to easily convert them between devices.</p>

<p>If you&#8217;ve worked with dynamic languages in the past like Java&trade;, PHP, Ruby, or Python&trade;, Monkey C should be very familiar.</p>

<h2 id="devicesandapis">Devices and APIs</h2>

<p>The problem of <em>API Fragmentation</em> is a challenge for app developers. If a developer takes advantage of new APIs, newer devices with less customer penetration may be targeted. If only established APIs are used, apps may not take advantage of new capabilities.</p>

<p>Garmin devices each have some differences you&#8217;ll need to account for: round screens versus square screens, touch screens versus buttons, and a different array of sensors depending on the device purpose. While the Java philosophy of &#8220;write once run anywhere&#8221; is a notable goal, creating a universal API that crosses every Garmin device would inevitably become a lowest common denominator API.</p>

<p>Rather than attempting to abstract away differences in devices, Connect IQ APIs are tailored to the devices they run on. If a device has a magnetometer, the device should have available the Magnetometer API. If two devices each have a magnetometer, the API should be the same between them. If a device does not have a magnetometer, it will not provide that API.</p>

<h2 id="thetaoofconnectiq">The Tao of Connect IQ</h2>

<p>There is a rhyme and reason behind Monkey C to make it easier for developers to support the Garmin ecosystem of products:</p>

<ol>
<li><p><strong>The developer chooses what devices to support</strong></p>

<p>Connect IQ apps can run across multiple devices, but the intended devices are up to the developer. Not every device will be aimed at the markets the developer wants to target or provide the experience the developer wants to provide. The developer should not be forced to support devices they don&#8217;t want to.</p></li>
<li><p><strong>The developer tools should help developers support multiple devices</strong></p>

<p>The developer tools lessen the weight of supporting multiple devices. The Resource Compiler hides device specific palettes and orientations from the developer. It also allows per device override of resources, allowing different images, fonts, and page layouts to be specified in the resources XML. The simulator needs to expose only the APIs a particular device supports so the developer can test device support.</p></li>
<li><p><strong>Similar devices should have similar APIs</strong></p>

<p>Not all devices will be equal, but there is often commonality between them. Two different watches may have different display technologies, but they both support bitmaps, fonts, user events, <a href="http://www.thisisant.com/developer/ant-plus/ant-antplus-defined/" title="What are ANT and ANT+?">ANT/ANT+</a>, and <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy" title="Bluetooth low energy">BLE</a>. A developer writing a sports app should not have to completely rewrite their app to support multiple devices.</p></li>
<li><p><strong>At runtime, the developer can ask what the system &#8216;has&#8217;</strong></p>

<p>Connect IQ applications are dynamically linked to the system. If an app makes a reference to an API that does not exist on a particular system, the app will fail at runtime when the app references the API, not at load time like C++. This allows an app to avoid making the call by taking advantage of the &#8216;<code>has</code>&#8217; operator.</p></li>
</ol>

<h1 id="gettingstarted">Getting Started</h1>
<figure>
<img src="resources/programmers-guide/learning-monkey.png" style="max-width:408px;" title="What is step 3?" />
</figure>

<h2 id="theconnectiqsdkmanagerconnectiq3.2">The Connect IQ SDK Manager (Connect IQ 3.2)</h2>

<p>The Connect IQ SDK Manager application keeps your Connect IQ SDK and device library up to date. It will download SDK updates and new devices from the cloud as they become available.</p>

<h3 id="installingtheconnectiqsdkmanager">Installing the Connect IQ SDK Manager</h3>

<ol>
<li><p>Go to <a href="https://developer.garmin.com/connect-iq/sdk">developer.garmin.com/connect-iq/sdk</a></p></li>
<li><p>In the <strong>Install the SDK Manager</strong> section select <em>Accept &amp; Download</em></p></li>
<li><p>Create a new folder in a convenient location</p>

<ol>
<li><strong>Windows and Linux</strong> - Copy the executable and support files to the new folder</li>
<li><strong>Mac</strong> - Open the disk image and copy the SDK manager to the new folder</li>
</ol></li>
<li><p>Launch the SDK Manager. You should see the following:
 <figure>
 <img src="resources/programmers-guide/sdk-manager-start.png" style="max-width:552px;" title="Launching the SDK Manager" />
 </figure></p></li>
<li><p>Press the <strong>Login</strong> button and enter the credentials of the Connect account:
 <figure>
 <img src="resources/programmers-guide/sdk-manager-login.png" style="max-width:552px;" title="Credential entry" />
 </figure></p></li>
<li><p>The SDK Manager can remember your credentials or you can re-enter them every time. Select which option you prefer and press <strong>Next</strong></p></li>
<li><p>You&#8217;ll be presented with the option of having the Connect IQ SDK update automatically, or to be notified when a new version is available. Select the option you prefer and press <strong>Next</strong>
 <figure>
 <img src="resources/programmers-guide/sdk-manager-update-sdk.png" style="max-width:552px;" title="Update SDK" />
 </figure></p></li>
<li><p>You&#8217;ll be presented with the option of having Connect IQ devices update, or to be notified when new devices are available. If you want to update devices automatically, you can choose the types of devices you want updates for. Select the option you prefer and press <strong>Finish</strong>
 <figure>
 <img src="resources/programmers-guide/sdk-manager-update-devices.png" style="max-width:552px;" title="Update devices" />
 </figure></p></li>
</ol>

<p>The SDK Manager has two tabs: <strong>SDK</strong> and <strong>Devices</strong>. The SDK tab shows what SDKs are available. Use the <img src="resources/programmers-guide/sdk-manager-download-button.png" style="max-width:20px" title="download"> button to download and install a SDK. Use the <img src="resources/programmers-guide/sdk-manager-x-button.png" style="max-width:20px" title="delete"> to un-install a SDK. Use the &#8220;Use as SDK&#8221; button to set the active SDK.</p>
<figure>
<img src="resources/programmers-guide/sdk-manager-sdk-tab.png" style="max-width:602px;" title="SDK tab" />
</figure>

<p>The Devices tab shows the devices available for the SDK. If a new device is available for download a <img src="resources/programmers-guide/sdk-manager-download-button.png" style="max-width:20px" title="download"> button will appear next to it. If a device is being updated a spinner will appear next to it. Finally, the <img src="resources/programmers-guide/sdk-manager-x-button.png" style="max-width:20px" title="delete"> can be used to remove a device.</p>
<figure>
<img src="resources/programmers-guide/sdk-manager-devices-tab.png" style="max-width:602px;" title="Devices tab" />
</figure>

<h2 id="theeclipseplug-in">The Eclipse Plug-in</h2>

<p>The Connect IQ Eclipse plug-in turns Eclipse into a Connect IQ development environment. Its features include:</p>

<ul>
<li>Syntax highlighting editor</li>
<li>Build integration</li>
<li>Integrated execution of applications in the Connect IQ simulator</li>
</ul>

<p>The Connect IQ plug-in requires either the Standard Edition or IDE for Java Developers (either 32 or 64 bit) of <a href="http://www.eclipse.org/" title="Eclipse">Eclipse Mars</a> or newer and <a href="http://java.com/en/download/" title="Java JRE">Oracle Java&trade; Runtime Environment 8</a> (version 1.8.0 or higher).</p>

<h3 id="installingtheeclipsexmleditor">Installing the Eclipse XML Editor</h3>

<p>Before you can install the Connect IQ plug-in you must make sure you have the Eclipse XML editor and tools installed.</p>

<ol>
<li><p>In the top menu, go to <em>Help &gt; Install New Software</em>:</p></li>
<li><p>Select your Eclipse distribution (Mars, Neon, etc.) from the available update sites.</p></li>
<li><p>Check the box next to <em>Web, XML, Java EE and OSGi Enterprise Development &gt; Eclipse XML Editor and Tools</em>.<a href="#fn:1" id="fnref:1" title="see footnote" class="footnote">[1]</a></p></li>
</ol>
 <figure>
 <img src="resources/programmers-guide/xml_editor.png" style="max-width:622px;" title="Eclipse XML Editor and Tools" />
 </figure>

<h3 id="settheactivesdk">Set the Active SDK</h3>

<p>Before installing the plugin, make sure you have <a href="#theconnectiqsdkmanagerconnectiq3.2">installed the Connect IQ SDK manager</a>, downloaded the SDK, and set the active SDK.</p>

<h3 id="installingtheeclipseplug-in">Installing the Eclipse Plug-in</h3>

<ol>
<li>In the top menu, go to <em>Help &gt; Install New Software</em>:</li>
</ol>
 <figure>
 <img src="resources/programmers-guide/install_new_software.png" style="max-width:616px;" title="The install new software window" />
 </figure>

<ol>
<li>Use the <em>Add&#8230;</em> button to add <em>https://developer.garmin.com/downloads/connect-iq/eclipse/</em>:</li>
</ol>
 <figure>
 <img src="resources/programmers-guide/edit_site.png" style="max-width:489px;" title="The edit site dialog box" />
 </figure>

<ol>
<li>Check the box next to Connect IQ in the list and hit <em>Next</em>:</li>
</ol>
 <figure>
 <img src="resources/programmers-guide/update_sites.png" style="max-width:616px;" title="The newly added Connect IQ update site" />
 </figure>

<ol>
<li>Dependent plug-in modules may need to be downloaded and installed. When this is complete, restart Eclipse to complete the installation.</li>
</ol>

<h3 id="addtheperspective">Add the Perspective</h3>

<p>Add the Connect IQ perspective to Eclipse by selecting <em>Window &gt; Open Perspective &gt; Other&#8230;</em> and then select <em>Connect IQ</em>:</p>
<figure>
<img src="resources/programmers-guide/perspective.png" style="max-width:359px;" title="Selecting the Connect IQ persepctive" />
</figure>

<h3 id="windowssourcefileencoding">Windows Source File Encoding</h3>

<p>If you are using eclipse in windows, make sure the <em>Text file encoding</em> is changed to <em>UTF&#8211;8</em> under <em>Windows &gt; General &gt; Workspace</em> or as shown below, this will ensure all string literals that appear in your source code or are displayed on the console are handled properly.<br>
Note: Mac and Linux should already have the default encoding set to <em>UTF&#8211;8</em>, but still better to check just to be sure.
 <figure>
 <img src="resources/programmers-guide/eclipse-encoding.png" style="max-width:737px;" title="Windows Source File Encoding" />
 </figure></p>

<h2 id="generatingadeveloperkey">Generating a Developer Key</h2>

<p>The Connect IQ compiler requires a developer key to sign apps when they&#8217;re compiled and packaged. The required key must be a RSA 4096 bit private key.</p>

<p><strong>Note</strong>: It&#8217;s important you keep track of the key you use to sign app packages. You will need to use the same key to sign updates to an existing app on the store. If you lose your original signing key you will not be able to update your app.</p>

<h3 id="generatingakeyusingtheeclipseplug-in">Generating a Key Using the Eclipse Plug-in</h3>

<p>If you&#8217;re using the Eclipse Plug-in there is a key generation utility built-in. Here&#8217;s how to use it:</p>

<ol>
<li>In the top menu, go to <em>Preferences &gt; Connect IQ &gt; Compiler</em></li>
<li>Click the <em>Generate</em> button to open the wizard</li>
<li>Set the output location for your developer key</li>
<li>Click <em>Finish</em> to create the key</li>
</ol>
<figure>
<img src="resources/programmers-guide/generate_key_wizard.png" style="max-width:814px;" title="The key generation wizard" />
</figure>

<p>The developer key specified in the Connect IQ compiler preferences will automatically be passed to the compiler when a project is compiled.</p>

<h2 id="settingupthecommandline">Setting Up the Command Line</h2>

<p>Before getting started with the installation on Mac or Windows, you&#8217;ll need <a href="http://java.com/en/download/" title="Java JRE">Oracle Java&trade; Runtime Environment 8</a> (version 1.8.0 or higher) installed. Once that&#8217;s done, continue on to your platform&#8217;s installation instructions.</p>

<h3 id="osxinstallation">OS X Installation</h3>

<ol>
<li><a href="#theconnectiqsdkmanagerconnectiq3.2">Install the Connect IQ SDK manager</a>, download the SDK, and set the active SDK.</li>
<li>Point your <code>PATH</code> to the active Connect IQ bin directory in the Terminal. To temporarily add it to a single local shell instance:</li>
</ol>

<pre><code class="bash">$ export PATH=$PATH:`cat $HOME/Library/Application\ Support/Garmin/ConnectIQ/current-sdk.cfg`/bin
</code></pre>

<p>For a more persistent addition, open <code>.bash_profile</code> in a text editor:</p>

<pre><code class="bash">$ touch ~/.bash_profile
$ open ~/.bash_profile
</code></pre>

<p>Then add the line below to the file and save the changes:</p>

<pre><code class="bash">export PATH=$PATH:`cat $HOME/Library/Application\ Support/Garmin/ConnectIQ/current-sdk.cfg`/bin
</code></pre>

<h3 id="windowsinstallation">Windows Installation</h3>

<ol>
<li><a href="#theconnectiqsdkmanagerconnectiq3.2">Install the Connect IQ SDK manager</a>, download the SDK, and set the active SDK.</li>
<li>Point your <code>PATH</code> to the active Connect IQ bin directory in the command prompt:</li>
</ol>

<pre><code class="bash">&gt; for /f usebackq %i in (%APPDATA%\Garmin\ConnectIQ\current-sdk.cfg) do set CIQ_HOME=%~pi
&gt; set PATH=%PATH%;%CIQ_HOME%\bin
</code></pre>

<h3 id="linuxinstallation">Linux Installation</h3>

<ol>
<li><a href="#theconnectiqsdkmanagerconnectiq3.2">Install the Connect IQ SDK manager</a>, download the SDK, and set the active SDK.</li>
<li>Point your <code>PATH</code> to the active Connect IQ bin directory in the command prompt:</li>
</ol>

<pre><code class="bash">$ export PATH=$PATH:`cat $HOME/.Garmin/ConnectIQ/current-sdk.cfg`/bin
</code></pre>

<p>For a more persistent addition, open <code>.bash_profile</code> in a text editor:</p>

<pre><code class="bash">$ touch ~/.bash_profile
$ nano ~/.bash_profile
</code></pre>

<p>Then add the line below to the file and save the changes: CTRL-X</p>

<pre><code class="bash">export PATH=$PATH:`cat $HOME/.Garmin/ConnectIQ/current-sdk.cfg`/bin
</code></pre>

<h3 id="basiccommands">Basic Commands</h3>

<p>After installation, three new shell commands are available: <code>connectiq</code>, <code>monkeyc</code>, and <code>monkeydo</code>.</p>

<ul>
<li><p><code>connectiq</code> launches the Connect IQ simulator, which can be used to run and test apps on your computer before running them on your device. In the simulator, your app will only have access to those APIs that are available on the currently simulated device. For example, an API only available in Connect IQ v2.2.x or higher, such as <code>PersistedContent</code>, will not be available on devices that run earlier versions of Connect IQ.</p></li>
<li><p><code>monkeyc</code> calls the Monkey C compiler. The compiler can take code from multiple files and link them together into a single Connect IQ executable (a PRG file). The usage is:</p></li>
</ul>

<pre><code class="bash">&gt; monkeyc [-d &lt;arg&gt;] [-f &lt;arg&gt;] [-o &lt;arg&gt;] [-y &lt;arg&gt;]
</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Argument</th>
	<th style="text-align:left;">Definition</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>-d &lt;arg&gt;</code></td>
	<td style="text-align:left;">Target device</td>
</tr>
<tr>
	<td style="text-align:left;"><code>-f &lt;arg&gt;</code></td>
	<td style="text-align:left;">Jungle files</td>
</tr>
<tr>
	<td style="text-align:left;"><code>-o &lt;arg&gt;</code></td>
	<td style="text-align:left;">Output file to create</td>
</tr>
<tr>
	<td style="text-align:left;"><code>-y &lt;arg&gt;</code></td>
	<td style="text-align:left;"><a href="#generatingadeveloperkey">Private key</a> to sign builds with</td>
</tr>
</tbody>
</table>

<ul>
<li><code>monkeydo</code> runs a Connect IQ executable in the simulator. You must have previously started the simulator with <code>connectiq</code>. The usage is:</li>
</ul>

<pre><code class="bash">monkeydo [executable] [device_id] [-t | -t test_name]
</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Argument</th>
	<th style="text-align:left;">Definition</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>executable</code></td>
	<td style="text-align:left;">A Connect IQ executable (PRG) to run</td>
</tr>
<tr>
	<td style="text-align:left;"><code>device_id</code></td>
	<td style="text-align:left;">The device to simulate (e.g. &#8220;fenix5plus&#8221;)</td>
</tr>
<tr>
	<td style="text-align:left;"><code>-t</code></td>
	<td style="text-align:left;">Execute Run No Evil unit tests. Supply an optional test method or class name to only run that test or set of tests.</td>
</tr>
</tbody>
</table>

<p>Here is an example of a basic build and run cycle from the command line:</p>

<pre><code class="bash">// Launch the simulator:
&gt; connectiq

// Compile the executable:
&gt; monkeyc -d fenix5plus -f /path/to/monkey.jungle -o project_name.prg -y /path/to/Dev_Key

// Run in the simulator
&gt; monkeydo myApp.prg fenix5plus
</code></pre>

<p><strong>Note:</strong> For more information on the <code>-f</code> option and the Jungle build framework, see the <a href="https://developer.garmin.com/connect-iq/reference-guides/jungle-reference/">Overriding Resources</a> section of this guide.</p>

<h3 id="generatingakeyusingopenssl">Generating a Key Using OpenSSL</h3>

<p>If you&#8217;re working from the command line you can generate a RSA key using <a href="https://www.openssl.org/">OpenSSL</a>. The following command will generate a valid signing key.</p>

<pre><code class="bash">&gt; openssl genrsa -out developer_key.pem 4096
&gt; openssl pkcs8 -topk8 -inform PEM -outform DER -in developer_key.pem -out developer_key.der -nocrypt
</code></pre>

<p>This developer key, <code>developer_key.der</code>, is passed to the compiler using the <code>-y</code> command line option.</p>

<h1 id="yourfirstconnectiqapp">Your First Connect IQ App</h1>

<h2 id="creatingyourfirstproject">Creating Your First Project</h2>

<ol>
<li><p>Click the <em>File</em> menu, and choose <em>New &gt; Project</em></p></li>
<li><p>Select <em>Connect IQ Project</em> and click <em>Next</em> to continue:</p>
<figure>
<img src="resources/programmers-guide/new_project.png" style="max-width:525px;" title="Creating a new Connect IQ project" />
</figure></li>
<li><p>Enter a name for your project and click <em>Next</em>:</p>
<figure>
<img src="resources/programmers-guide/project_name.png" style="max-width:525px;" title="Entering the name of the project" />
</figure></li>
<li><p>Set the project type to <em>Watch Face</em></p></li>
<li><p>Leave the minimum SDK version at the default, and click <em>Next</em>:</p>
<figure>
<img src="resources/programmers-guide/project_type.png" style="max-width:525px;" title="Selecting the project type" />
</figure></li>
<li><p>Select the <em>Simple</em> template, upon which the project will be based:</p>
<figure>
<img src="resources/programmers-guide/new_project_template.png" style="max-width:525px;" title="Selecting the project template" />
</figure></li>
<li><p>Select the desired target devices to support:</p>
<figure>
<img src="resources/programmers-guide/new_project_devices.png" style="max-width:525px;" title="Selecting the project devices" />
</figure></li>
<li><p>Select <em>English</em> as the supported language, and click <em>Finish</em>:</p>
<figure>
<img src="resources/programmers-guide/new_project_language.png" style="max-width:525px;" title="Selecting the supported languages" />
</figure>

<p>Eclipse will create the project and move to the Connect IQ perspective. Once the project is initialized, the following project elements will be created automatically:</p>
<figure>
<img src="resources/programmers-guide/new_project_structure.png" style="max-width:264px;" title="The basic structure of a new Connect IQ project" />
</figure></li>
</ol>

<dl>
<dt>bin</dt>
<dd>Contains binary and debug output from the app compilation</dd>

<dt>resources</dt>
<dd>Inputs to the resource compiler, such as layouts, images, fonts, and strings, and language-specific resources</dd>

<dt>source</dt>
<dd>Contains the Monkey C source files, initially broken into &#8216;App&#8217; and &#8216;View&#8217; files</dd>

<dt>manifest.xml</dt>
<dd>Application properties like the app id, the app type, and the targeted devices</dd>
</dl>

<h3 id="abouttheminimumsdkversionfield">About the Minimum SDK Version Field</h3>

<p>The minimum SDK version allows you to configure device compatibility by enforcing that only devices that support, at a minimum, the SDK version you&#8217;ve selected to be enabled for your app.
For example, if your app relies heavily on a feature of the <strong>2.1.x</strong> SDK, such as the <strong>Sensor History</strong> feature, you can set your minimum SDK version to <strong>2.1.x</strong> and the list of available devices will be pruned such that you cannot select an incompatible product.</p>

<h2 id="runningtheprogram">Running the Program</h2>

<p>Before running the app for the first time, you may wish to set up a <em>Run Configuration</em> in Eclipse, a pre-selected set of options with which to run a project to help speed development. For example, you may create one to execute your app as a widget on the f&emacr;nix 3. Once configured, new run configurations only need to be added if new app or device configurations are needed.</p>

<p>To add a run configuration:</p>

<ol>
<li><p>Click the <em>Run &gt; Run Configurations</em> menu</p></li>
<li><p>Right click on the <em>Connect IQ App</em> option in the list on the left side of the window, and select <em>New</em>:</p>

<p><figure>
<img src="resources/programmers-guide/run_configuration.png" style="max-width:729px;" title="Creating a Run Configuration" /></p></li>
<li><p>Give the configuration a name at the top</p></li>
<li><p>Choose the Connect IQ project that will use this configuration (It should automatically select your current project, but the Project button can be used to select a different one)</p></li>
<li><p>Choose a target device</p></li>
<li><p>Select the SDK version to target. Only SDK versions compatible with your selected device will be displayed.</p></li>
<li><p>Click <em>Apply</em> and <em>Close</em>:</p></li>
</ol>

<p>Before running your program, start the Connect IQ simulator by clicking the <em>Connect IQ</em> menu and selecting <em>Start Simulator</em>, or clicking on the start simulator icon <img src="resources/programmers-guide/sim_icon.png" style="max-width:16px;" role="presentation"/> in the toolbar. A blank simulator window will appear.</p>

<p>With a Run Configuration created and the simulator started, you&#8217;re ready to go! Use the down arrow next to the <em>Run &gt; Run Configurations</em> menu (or from the <em>Run Configurations</em> selector on the toolbar) to select your configuration.</p>

<p>If all goes well the following run output will appear in the console:</p>

<pre><code>Found Transport: tcp
Connecting...
Connecting to device...
Device Version 0.1.0
Device id 1 name &quot;A garmin device&quot;
Shell Version 0.1.0
Connection Finished
Closing shell and usb
</code></pre>

<p>&#8230;and the watch will appear in the simulator:</p>
<figure>
<img src="resources/programmers-guide/first_app.png" style="max-width:304px;" title="The app running in the simulator" />
</figure>

<h3 id="aboutthetargetsdkversionfield">About the Target SDK Version Field</h3>

<p>The target SDK version field is populated with the versions of the SDK that the device you&#8217;ve selected supports. When selecting a target SDK, you are telling the compiler to target that SDK&#8217;s feature set when building your app.</p>

<h2 id="importinganexample">Importing an Example</h2>

<p>To try one of the Connect IQ sample apps, import it into your Eclipse workspace:</p>

<ol>
<li><p>Click the <em>File</em> menu</p></li>
<li><p>Select <em>Import&#8230;</em></p></li>
<li><p>Choose <em>Existing Projects into Workspace</em> under the <em>General</em> section of the window, and click <em>Next</em>:</p>
<figure>
<img src="resources/programmers-guide/import_select.png" style="max-width:525px;" title="Selecting an existing project to import" />
</figure></li>
<li><p>Click the <em>Browse</em> button and select the root directory of the sample to import:</p>
<figure>
<img src="resources/programmers-guide/import_project.png" style="max-width:525px;" title="Choosing the location of the project to import" />
</figure></li>
<li><p>Check all projects to import that are listed in the Projects window (in the example above, only one project is listed)</p></li>
<li><p>If there are multiple projects in the root directory, check <em>Search for nested projects</em> to ensure that Eclipse locates all potential projects</p></li>
<li><p>If you prefer to work with a copy of the project, check <em>Copy projects into workspace</em></p></li>
<li><p>Click <em>Finish</em> to complete the import</p></li>
</ol>

<h2 id="sideloadinganapp">Side Loading an App</h2>

<p>The Eclipse plug-in provides a wizard to help developers side load an application. Here&#8217;s how to use it:</p>

<ol>
<li><p>Click the <em>Connect IQ</em> menu</p></li>
<li><p>Select <em>Build Project for Device</em> to open the wizard</p></li>
<li><p>Choose the project and device for which you wish to build from the drop down menus</p></li>
<li><p>Select the SDK version you would like to target. Only SDK versions compatible with the selected device will be displayed.</p></li>
<li><p>Set the path to the private key to use to sign your app. See <a href="#generatingakeyusingtheeclipseplug-in">Generating a Key Using the Eclipse Plug-in</a> for instructions on creating a key.</p></li>
<li><p>Set the output directory to your device&#8217;s <code>GARMIN/APPS</code> directory</p></li>
<li><p>Click the <em>Build</em> button.</p>
<figure>
<img src="resources/programmers-guide/build_for_device.png" style="max-width:525px;" title="The Build for Device Wizard" />
</figure></li>
</ol>

<p>The wizard will create an executable (PRG) of the selected project and save it to your device for testing.</p>

<p>If you are unable to choose a device for which to build (the menu appears empty), it means that there are no valid devices configured for your project. For example, the Square Watch and Round Watch device types are valid for simulation only and do not represent physical devices for which apps may be built.</p>

<p>To configure additional target platforms for your project:</p>

<ol>
<li>Double click on the <code>manifest.xml</code> in the project explorer to open the manifest editor.</li>
<li>Select the <em>Build Targets</em> tab.
<figure>
<img src="resources/programmers-guide/build_targets.png" style="max-width:388px;" title="Selecting the project type" />
</figure></li>
<li>Select all of the devices you want to release your app to.</li>
<li>Select <em>File, then Save</em> to save the updated <code>manifest.xml</code></li>
</ol>

<p>The devices in the manifest editor build targets will be disabled if they do not meet the minimum Connect IQ API level you have specified in your app manifest.</p>

<h1 id="watchfaces">Watch Faces</h1>

<p>Watch faces are a special application type that display on the main screen of Garmin&#8217;s wearable devices. These application types are limited some ways to allow them to have minimal impact on the device&#8217;s battery life.</p>

<p>Watch faces run continuously on the device and can have the most effect on power consumption. A poorly designed watch face &mdash; one that takes too long to draw &mdash; can greatly degrade the battery life of the wearable.</p>

<p>Due to these battery life concerns, watch faces have the least access to APIs in the system. They have access to graphics, bitmaps, fonts, current activity tracker status, current battery status, and the user&#8217;s activity profile. They cannot access the compass, GPS, or other sensors.</p>

<p>If you use custom fonts for numeric display, use the filter option to only load the critical glyphs. This will save memory that you can use for additional graphics</p>

<h2 id="watchfacesleep">Watchface sleep</h2>

<p>Watchfaces spend the majority of the time in &#8220;Sleep Mode&#8221; in this mode, execution is restricted to updates once each minute, and cannot use timers or animations. When a user raises the watch to look at it, the watchface exits sleep mode. When this occurs, the <code>onExitSleep()</code> method is called, and updates will increase to once per second, and timers and animations are allowed until the <code>onEnterSleep()</code> method is called.</p>

<pre><code class="java">module WatchUi
{
    //! The WatchFace class is used for creating watch faces
    //! that support exiting/entering low power mode.
    //! The developer will use the WatchFace View to tie in
    //! to gestures. This will enable the watchface to update
    //! at a faster rate than once a minute when the user has brought
    //! the watch &quot;up&quot;, presumably to look at it. &quot;Sleep&quot;
    //! will be entered when the user looks away (lowers the watch)
    //! or the watch times out and automatically reenters sleep.
    //! @since 1.0.0
    class WatchFace extends Toybox.WatchUi.View
    {
        //! onEnterSleep() is called when the watch is entering sleep mode.
        //! Terminate any active timers and prepare for slow updates.
        //! @since 1.0.0
        function onEnterSleep();

        //! onExitSleep() is called when the watch is exiting sleep mode.
        //! Timers and animations may be started here.
        //! @since 1.0.0
        function onExitSleep();
    }
}
</code></pre>

<h2 id="watchfacedelegateconnectiq2.3">WatchFaceDelegate (Connect IQ 2.3)</h2>

<p>The WatchFaceDelegate provides input from the system to watchfaces. The delegate should be returned as the second element of the array returned from <code>getInitialView()</code> similar to input delegates for other application types. This delegate is currently only used to report power budget violations for watchfaces that support every second updates. If the execution budget is exceeded over the course of a minute, the <code>onPowerBudgetExceeded()</code> callback will be invoked, providing information about the execution time of the watchface, and the limit that was exceeded.</p>

<pre><code class="java">module WatchUi
{
    //! The WatchFace delegate is used to recieve events on a watchface
    //! @since 2.3.0
    class WatchFaceDelegate
    {
        //! If the onPartialUpdate callback of the associated watchface view
        //! Exceeds power budget, onPowerBudgetExceeded will be called with
        //! information about the limits that were exceeded.
        //! @param [WatchUi.WatchFacePowerInfo] powerInfo The info object
        //! @since 2.3.0
        function onPowerBudgetExceeded(powerInfo);
    }

    //! @since 2.3.0
    class WatchFacePowerInfo
    {
        //! The average time onPartialUpdate took to complete.
        //! @return [Float] Average elapsed time per update in milliseconds
        //! @since 2.3.0
        var executionTimeAverage;
        //! The maximum time onPartialUpdate is allowed to take.
        //! @return [Float] Maximul allowed time in milliseconds
        //! @since 2.3.0
        var executionTimeLimit;
    }
}
</code></pre>

<h1 id="datafields">Data Fields</h1>
<figure>
<img src="resources/programmers-guide/cyclist-monkey.png" style="max-width:300px;" title="He's going for top banana." />
</figure>

<p>Dynamic data fields allow customers and third party developers to write additional metrics and data that will display with Garmin activities. The goal is to create a system that not only makes it easy for a user to make a quick data field based off our workout data, but also gives the developer the the ability to customize the presentation.</p>

<p>Data fields can display during an already supported activity on the device. They are a great way to provide new metrics to users by performing calculations on data that is already being recorded. Data fields are integrated within existing activities, so it&#8217;s best if they appear in the same font and format as that used for the native data fields on the device. For that reason, the simple layout is best, as it will ensure your data field will have the same native look and will scale appropriately to all data screen layouts. If you would like to customize your data field, for example, by inserting a bitmap in place of a numerical value, you will need to ensure that your custom field will scale appropriately among one-field, two-field, three-field, etc. layouts.</p>

<h2 id="datafieldandsimpledatafield">Datafield and SimpleDataField</h2>

<p>The base class for data fields is <code>WatchUi.DataField</code>. This class extends <code>WatchUi.View</code>, and in many ways behaves similarly to other <code>WatchUi</code> View objects. The <code>onUpdate()</code> method call will be made every time the watch needs to update.</p>

<p>In Garmin activities, the user controls the data page layout; specifically, whether it displays one, two, three, or more fields. The Connect IQ data field must handle displaying in all of those layouts, and the developer can use the simulator to test their field in all layouts supported by devices.</p>

<p>Many developers will only want to display a single value and not want to handle all the complexity of the drawing of a data field. In those instances, they can use a <code>SimpleDataField</code> object. A simple data field handles the drawing of the field in multiple sizes, and only requires the developer to implement a <code>compute()</code> method. The <code>compute()</code> method is passed an <code>Activity.Info</code> object, which contains all current workout information.</p>

<p>Use a <code>SimpleDataField</code> when possible to guarantee your data field will have the native look and feel of the other Garmin Data Fields. Connect IQ will try to ensure your data displays with the best font and layout possible.</p>

<p>The following is an example of a &#8220;Beers Earned&#8221; data field, which displays how many beers you have &#8220;earned&#8221; during your workout:</p>

<pre><code class="typescript">using Toybox.Application;
using Toybox.WatchUi;

class BeerView extends WatchUi.SimpleField
{
    function initialize() {
        units = &quot;beers&quot;;
    }

    function compute(info) {
        return info.calories / 150; // Calories in average bottle of beer
    }
}

class BeersEarned extends Application.AppBase
{
    function getInitialView() {
        return new BeerView();
    }
}
</code></pre>

<h3 id="activityinfo">Activity Info</h3>

<p>The <code>compute()</code> method will be called before update in a data field. This method allows the developer to run a computation based on the workout information. The workout information is passed in as a <code>Toybox.Activity.Info</code> object. This object contains all the info about the workout that is computed by the system:</p>

<pre><code class="typescript">module Activity
{
    class Info
    {
        var startLocation;              // Starting location of the activity, a Location object
        var startTime;                  // Starting time of activity, a Moment object
        var elapsedTime;                // Elapsed time of the activity in ms
        var timerTime;                  // Timer time in milliseconds
        var elapsedDistance;            // Distance in meters
        var currentLocationAccuracy;    // GPS Accuracy - See location constant
        var currentLocation;            // Current location, a Location object
        var calories;                   // Calories in kcal
        var currentSpeed;               // Speed in meters per second
        var averageSpeed;               // Average speed in meters per second
        var maxSpeed;                   // Maximum speed in meters per second
        var currentPace;                // Current pace in meters per second
        var currentPower;               // Current power in watts
        var averagePower;               // Average power in watts
        var maxPower;                   // Maximum power in watts
        var totalAscent;                // Total ascent in meters
        var totalDescent;               // Total descent in meters
        var currentHeartRate;           // Current heart rate in beats per minute
        var averageHeartRate;           // Average heart rate in beats per minute
        var maxHeartRate;               // Maximum heart rate in beats per minute
        var currentCadence;             // Current cadence in revolutions per minute
        var averageCadence;             // Average cadence in revolutions per minute
        var maximumCadence;             // Maximum cadence in revolutions per minute
        var swimStrokeType;             // Swim stroke type
        var swimSwolf;                  // Swim SWOLF
        var averageDistance;            // Swim stroke average distance
        var currentHeading;             // Current heading in radians
        // ...
    }
}
</code></pre>

<p>Read more about <code>compute()</code> in the <a href="https://developer.garmin.com/connect-iq/api-docs/Toybox/WatchUi/DataField.html#compute-instance_function)">API documentation</a> to gain a better understanding of it&#8217;s uses and possible limitations.</p>

<p>The following is the API for the data fields:</p>

<pre><code class="typescript">// The DataField class is used for creating data fields. In a DataField, the
// developer will implement a compute method, which is called by the system once
// per second, with an Activity.Info object. The system will call the onUpdate()
// method inherited from View when the field is displayed by the system.
class DataField extends View
{
    // To retrieve Activity.Info data for DataFields, it is necessary to override compute().
    // This is the method that is called to update the field information.
    // @param [Activity.Info] info The updated Activity.Info object
    function compute( info );
}

// The SimpleDataField class is used for creating simple data fields.
// In a SimpleDataField, the developer is only required to implement a compute
// method. The compute method is passed an Activity.Info object, which contains
// all current workout information. The compute method should return a value to
// be displayed.  Allowed types are Number, Float, Long, Double, and String.
// The SimpleDataField also contains a variable &quot;label&quot;.  This variable should
// be assigned to a String label for the field.
class SimpleDataField extends DataField
{
    //! Constructor
    function initialize();

    //! To retrieve Activity.Info data for DataFields, it is necessary to override compute().
    //! This is the method that is called to update the field information.
    //! @param [Activity.Info] info The updated Activity.Info object
    function compute( info );
}
</code></pre>

<h2 id="simulatingaworkout">Simulating a Workout</h2>

<p>To test your data field in the simulator, feed your data field simulated databy clicking the <em>Simulation</em> menu, choose <em>FIT Data</em> and then <em>Simulate</em>. This will generate random but valid data. You can also use <em>Simulation</em> &gt; <em>FIT Data</em> &gt; <em>Playback File&#8230;</em> to simulate a workout by using a pre-recorded FIT file.</p>

<h1 id="deviceapps">Device Apps</h1>

<p>Device apps are by far the most robust type of app available. These allow the most flexibility and customization to the app designer. They also provide the most access to the capabilities of the wearable device, such as accessing ANT+ sensors, the accelerometer and reading/recording FIT files.</p>

<p>The suite of Garmin wearables are each designed to fulfill different needs and behaviors of active individuals, from endurance runners to triathletes to outdoor enthusiasts and adventurers. The core focus of these wearables centers on the recording and tracking of activities, from running to hiking to skiing. Users of the different Garmin wearables desire to track specific types of data and great care should be taken in designing your watch app to understand the needs of the user doing a particular activity or task and provide appropriate feedback, metrics and configurability to give the user the best experience.</p>

<p>The initial view of the app should be a call to action. If your app represents some form of activity like hiking or weight lifting, the initial view of the app should ask to be started. Present the user with information from the sensors that make them want to hit the start button.</p>

<p>Garmin commonly uses page loops to present multiple pages of information. Page loops are a carousel of pages, each one a unique view on the activity. This is a common metaphor in Garmin products and easy to implement in Connect IQ.</p>

<p>When your app is presenting large amounts of text to the user, try to keep information in the center of the screen. On round screens the top and bottom of the screen provide a limited viewing area. Use the top for contextual headers, scroll arrows, and other small hints of information.</p>

<h1 id="widgets">Widgets</h1>

<p>Widgets are mini-apps that allow developers to provide glanceable views of information. The information may be from a cloud service, from the onboard sensors, or from other Connect IQ APIs. Widgets are launchable from a rotating carousel of pages accessible from the main screen of wearables, or from a side view on bike computers and outdoor handhelds. Unlike apps, Widgets time out after a period of inactivity and are not allowed to record activities, but they are also launchable at any time.</p>

<h2 id="baseviewandthewidgetcarousel">Base View and the Widget Carousel</h2>

<p>On wearable products the watch face is the home screen of the widget carousel. Users can use the up/down buttons (on button products) or up/down swipes (on touchscreen wearables) to navigate through the widgets.</p>

<p>When a widget launches the initial view returned from <code>getInitialView</code> is shown. Since they are used for widget navigation, the <code>InputHandler</code> will never receive either the up/down button or up/down swipe events when the base view is shown. Any views pushed on top of the base view using <code>WatchUi.pushView</code> will not have these input restrictions.</p>

<p>The expectation for all views in the widget loop is that the system menu shows when the user performs the menu behavior. For widgets, the first item on the system menu will be to view the menu options for the widget. When the user makes that selection, your widget&#8217;s <code>BehaviorDelegate</code> object&#8217;s <code>onMenu</code> function will be called.</p>

<h2 id="glancesconnectiq3.1">Glances (Connect IQ 3.1)</h2>

<p>The Fenix 6 moved glanceable information from a page carousel presentation to a list presentation. Each item offers a small area of real-estate to display information. If the user selects it the full widget is launched. When launched in this context, the widget base view don&#8217;t have the input restrictions regularly applied.</p>

<p>Glance views run in a limited runtime space, with reduced memory and privileges and do not accept any input.</p>

<h2 id="designingawidget">Designing a Widget</h2>

<p>Your widget should be designed with both a glance and a base view. Your base view and glance should both offer a simple summary of the presented data. If the user performs a behavior (pressing the start button, touching the screen) that indicates they want more information, your widget should then push a view that allows navigation through the offered information.</p>

<p>When your widget is launched, you can check if <code>DeviceInfo</code> has <code>isGlanceModeEnabled</code> defined. If it does, you can also determine what the value is. If glance mode is enabled you can launch directly into the interactive portion of your widget. Otherwise you should launch the base view.</p>

<h1 id="audiocontentproviders">Audio Content Providers</h1>

<p>Garmin media enabled devices are designed for active lifestyle users who want to listen to music without carrying their phone on their rides, runs or other activities. The media player allows the user to listen to their music, podcasts, and audio-books on the go.</p>

<p>Audio content providers function as plug-ins for the media player on media-enabled product. These apps act as bridges between music services and the Garmin media player. Audio content providers allow users to select content from a content provid.er, sync the content over Wi-Fi to the device, and listen to it</p>

<p>These apps have three contexts:</p>

<ol>
<li>Playback Configuration: Allows the user to select what content they want to listen to from what they have synced</li>
<li>Sync: The device activates Wi-Fi and allows the audio content provider to request content for later offline playback</li>
<li>Playback: The playback experience. The audio content provider tells the media player what to play based on the user&#8217;s selection.</li>
</ol>

<p>Sync Configuration has been deprecated. We recommend providing the user a mechanism to download content inside of the playback configuration.</p>

<div class="footnotes">
<hr />
<ol>

<li id="fn:1">
<p>Newer versions of the Eclipse installer will automatically include these tools. If you do not see them listed, then you may skip this step. <a href="#fnref:1" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

</ol>
</div>


</body>
</html>
